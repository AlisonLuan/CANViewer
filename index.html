<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="WebUSB-based CAN bus interface for logging and sending CAN messages directly from your browser.">
  <title>WebUSB CAN Interface</title>
  <!-- Main stylesheet -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Skip link for accessibility -->
  <a class="skip-link" href="#main-content">Skip to content</a>

  <header>
    <h1>WebUSB CAN Interface</h1>
    <!-- Top-level actions -->
    <nav aria-label="Main actions">
      <button
        type="button"
        id="connect-button"
        aria-controls="connect-status"
        aria-live="polite"
      >
        Connect
      </button>
      <span id="connect-status" role="status">Not Connected</span>
      <button
        type="button"
        id="export-button"
        aria-label="Export the full CAN log"
      >
        Export Log
      </button>
    </nav>
  </header>

  <main id="main-content">
    <!-- CAN bus log section -->
    <section id="log-section" aria-labelledby="log-heading">
      <h2 id="log-heading">CAN Bus Log</h2>
      <!-- Live region for incoming CAN messages -->
      <div id="log-table-wrapper" aria-live="polite">
        <table id="log-table" class="log-table">
          <caption>Received CAN messages with timestamps, identifiers, and data</caption>
          <thead>
            <tr>
              <th scope="col">Timestamp</th>
              <th scope="col">CAN ID</th>
              <th scope="col">Type</th>
              <th scope="col">DLC</th>
              <th scope="col">Data</th>
            </tr>
          </thead>
          <tbody id="log-body"><!-- Populated by JavaScript --></tbody>
        </table>
      </div>
    </section>

    <!-- Unique-message summary section (max 10 rows) -->
    <section id="unique-section" aria-labelledby="unique-heading">
      <h2 id="unique-heading">Unique CAN Messages</h2>
      <!-- Controls for unique list -->
      <div class="section-controls">
        <button type="button" id="clear-unique">Clear Unique</button>
      </div>
      <!-- Live region for unique message updates -->
      <div id="unique-table-wrapper" aria-live="polite">
        <table id="unique-table" class="log-table">
          <caption>Last 10 unique ID+type messages (most recent)</caption>
          <thead>
            <tr>
              <th scope="col">Timestamp</th>
              <th scope="col">CAN ID</th>
              <th scope="col">Type</th>
              <th scope="col">DLC</th>
              <th scope="col">Data</th>
              <th scope="col">Count</th>
            </tr>
          </thead>
          <tbody id="unique-body"><!-- Populated by JavaScript --></tbody>
        </table>
      </div>
    </section>

    <!-- CAN message sender section as table (up to 10 rows) -->
    <section id="sender-section" aria-labelledby="sender-heading">
      <h2 id="sender-heading">CAN Message Sender</h2>
      <!-- Control to add new messages -->
      <div class="section-controls">
        <button type="button" id="add-message">Add Message</button>
      </div>
      <div id="send-table-wrapper">
        <table id="send-table" class="log-table">
          <caption>Configure up to 10 messages to send</caption>
          <thead>
            <tr>
              <th scope="col">CAN ID</th>
              <th scope="col">Type</th>
              <th scope="col">Data</th>
              <th scope="col">Interval (ms)</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody id="send-body"><!-- Populated by JavaScript --></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Module script: load and initialize after DOM is ready -->
  <script type="module">
    import CanUsbLogger from './canUsbLogger.js';
    CanUsbLogger.init();
  </script>  
</body>
</html>
<!-- End of index.html -->